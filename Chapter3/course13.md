#第十三节 注册快捷栏到PlayerState与快捷栏切换和右手插槽   
    
##13.1 注册快捷栏到PlayerState   
1、**设置快捷栏**    
（1）上一节我们实现了快捷栏容器结构体，但是有两行代码是多余的，我们把它删掉：   
![](https://i.imgur.com/EUFkgxK.png)   
这一节我们先实例化一个结构体，把容器全部添加进这个结构体，我们先去SSlAiShortcutWidget.h，把数据结构的头文件SlAiTypes.h添加进去,然后创建它：    
![](https://i.imgur.com/LQ0bWba.png)   
然后去SlAiDataHandle.h下实现一个笔刷的数组：    
![](https://i.imgur.com/zzR5nj9.png)    
再去SlAiGameWidgetStyle.h下定义所有需要的笔刷：   
![](https://i.imgur.com/aOdM6Zs.png)   
之后我们去SlAiDataHandle.h下获取GameStyle:   
![](https://i.imgur.com/Uw7ZXeF.png)   
再去SlAiDataHandle.cpp添加一个头文件：SlAiGameWidgetStyle.h然后找到初始化物品属性那一条，把笔刷加进去：   
![](https://i.imgur.com/OMxPhbt.png)    
现在就可以去SSlAiShortcutWidget.cpp实例化结构体了：   
![](https://i.imgur.com/Yjm5Et0.png)     
然后引入一下头文件：SlAiDataHandle.h,再接着添加：   
![](https://i.imgur.com/7lQyFKm.png)    
然后为了结构好一点，我们把做委托，把委托绑到SlAiGameHUD.cpp下，那么我们现在SlAiGameHUD.h下添加如下代码：   
![](https://i.imgur.com/xgwv1v1.png)   
然后先去定义委托，然后再去cpp文件中实现它，我们先去SSlAiShortcutWidget.h定义委托：     
![](https://i.imgur.com/eaXt6qW.png)     
然后再创建这个委托的变量：    
![](https://i.imgur.com/LZWKZ3F.png)   
接下来我们去SlAiPlayerState.h下添加如下代码：   
![](https://i.imgur.com/49kPBlU.png)      
现在去SlAiPlayerState.h添加一下头文件并新建一个类：   
![](https://i.imgur.com/fKkogW3.png)     
然后在SlAiPlayerState.h下添加如下代码：    
![](https://i.imgur.com/JnbGffU.png)        
再去SlAiPlayerState.cpp下添加如下代码：    
![](https://i.imgur.com/LS3GnIv.png)    
接下来我们就要开始绑定委托，我们先获取指针，添加SlAiGameMode.h代码如下：     
![](https://i.imgur.com/E4FHrBP.png)    
现在我们来实现一下InitGamePlayModule:     
![](https://i.imgur.com/t3MZvDJ.png)    
然后我们先去SlAiGameHUD.h下添加指针：   
![](https://i.imgur.com/VOtlxzP.png)   
再去SlAiGameHUD.cpp添加如下代码：    
![](https://i.imgur.com/RCppxnA.png)    
回到SlAiGameHUD.h修改原先的代码如下：    
![](https://i.imgur.com/txpfmZ8.png)    
再去SlAiGameHUD.cpp接着写，先修改头文件如下：    
![](https://i.imgur.com/lDuhOaf.png)    
再添加内容如下：   
![](https://i.imgur.com/42PGA6m.png)     
但是现在运行游戏的话我们还是看不到快捷栏的东西，所以我们在SlAiPlayerState.cpp下添加一段临时的代码：    
![](https://i.imgur.com/pCIB48K.png)     
现在我们再去实例化SlAiPlayerState.h下的ASlAiPlayerState,然后再去ue4中设置物品的笔刷，我们对应序号给它们设置：    
![](https://i.imgur.com/v2Cy32J.png)   
最后我们运行一下看一下效果：   
![](https://i.imgur.com/14qE1hW.png)        
         
##13.2 快捷栏切换和右手插槽   
1、**快捷栏切换**    
（1）先去Project Settings下添加两个动作：     
![](https://i.imgur.com/sOhECnE.png)     
再去SlAiPlayerState.h下再添加一些变量：   
![](https://i.imgur.com/fGTTE63.png)   
接下来我们去cpp文件初始化一下：     
![](https://i.imgur.com/iPahdHV.png)       
然后就可以实现choose了：     
![](https://i.imgur.com/3b38kBu.png)    
我们先选一个公共方法，添加SlAiPlayerState.h代码如下：   
![](https://i.imgur.com/xCWTZxU.png)
现在我们重写一下GetShortcutInfoText让它根据物品来显示：     
![](https://i.imgur.com/nO6n6ov.png)
然后去cpp文件中初始化一下：    
![](https://i.imgur.com/mgID6fC.png)
还需要引入一下SlAiDataHandle的头文件，然后接着添加代码如下来看一下它当前是哪种语言：    
![](https://i.imgur.com/tgwVGG7.png)     
现在我们重写一下GetShortcutInfoText让它根据物品来显示：     
![](https://i.imgur.com/nO6n6ov.png)    
接下来去写一下滚轮事件，添加SlAiPlayerController.h代码如下：   
![](https://i.imgur.com/SNsJeaF.png)      
再去SetupInputComponent把这个事件绑定一下：    
![](https://i.imgur.com/2CcLHAk.png)    
我们还要回到。h文件，去添加一个方法：    
![](https://i.imgur.com/0SaSGMV.png)
再去cpp文件获取它，同时引入一下SlAiPlayerState.h这个头文件：    
![](https://i.imgur.com/wiNT7yD.png)
接着就可以继续实现这两个方法：    
![](https://i.imgur.com/QdUdnRV.png)
引入一下头文件SlAiPlayerState.h,然后我们希望在按着鼠标左键右键的时候不触发这个事件，所以回到.h文件，添加代码如下：    
![](https://i.imgur.com/P6i1VvD.png)    
然后将这两个布尔值在beginplay下初始一下：   
![](https://i.imgur.com/ymj4oS5.png)    
然后给他赋值：   
![](https://i.imgur.com/nVBzkyI.png)   
我们再加一个判断：
![](https://i.imgur.com/lNcJZ6R.png)    
现在我们就可以运行一下看效果了：   
![](https://i.imgur.com/aVBbpJs.png)    
     
1、**添加右手插槽**  
去到SlAiPlayerCharacter.h下添加如下代码：    
![](https://i.imgur.com/siXh8qs.png)     
现在我们去cpp文件实例化它：    
![](https://i.imgur.com/mmyzId5.png)     
再引入一下头文件：     
![](https://i.imgur.com/JSMyjnT.png)    
接下来就要绑定它到骨骼上，打开ue4，我们先去到第三和第一人称的骨骼，查看一下是否有插槽，如果有的话就接着下一步，打开vs，去SlAiPlayerCharacter.cpp下绑定：    
![](https://i.imgur.com/aCFMzPp.png)
接下来我们先运行一下ue4。然后创建一个actor：    
![](https://i.imgur.com/OYUqZh0.png)   
然后根据这个基类再继续创建8个类：   
![](https://i.imgur.com/w9ZRmhZ.png)    
![](https://i.imgur.com/NqMuvE2.png)    
![](https://i.imgur.com/3Twpl42.png)    
![](https://i.imgur.com/Of7xMxM.png)     
![](https://i.imgur.com/jzwokDh.png)   
![](https://i.imgur.com/u9LFPda.png)     
![](https://i.imgur.com/zP6xGEN.png)   
![](https://i.imgur.com/thgHdrb.png)    
![](https://i.imgur.com/7Lc8YUF.png)    
    
回到vs，在SlAiHandleObject.h下添加如下代码：    
![](https://i.imgur.com/nknZvr8.png)     
再去cpp文件添加如下代码：    
![](https://i.imgur.com/Q2MeqWq.png)    
我们现在去SlAiPlayerCharacter.cpp下引入头文件：    
![](https://i.imgur.com/8JKDpah.png)   
在添加如下代码：    
![](https://i.imgur.com/PDtdyfq.png)   
最后去SlAiHandObject.cpp下实例化一下BaseMesh:   
![](https://i.imgur.com/wyqkCSA.png)   
然后就可以运行了。   
