#第二十八节 敌人死亡AI和渲染小地图   
    
##28.1 敌人死亡AI   
1、**敌人死亡AI**    
（1）打开VS，去SlAiEnemyAnim.h添加一个函数：     
![](https://i.imgur.com/96ZftZP.png)       
然后去cpp文件实现它：    
![](https://i.imgur.com/WkkibXy.png)    
接下来我们去SlAiEnemyController.h下添加一个死亡函数：    
![](https://i.imgur.com/vVUIDqe.png)    
在添加一个销毁：    
![](https://i.imgur.com/C2xhfoH.png)    
接下来去cpp文件实现它们：    
![](https://i.imgur.com/vaZ7I0m.png)      
![](https://i.imgur.com/jPPytQa.png)    
然后去.h文件添加动画资源：    
![](https://i.imgur.com/gpdg48d.png)    
![](https://i.imgur.com/0lGYrQI.png)    
![](https://i.imgur.com/rQoDg7N.png)    
![](https://i.imgur.com/EVfm7M0.png)   
接下来去cpp文件实现它们：   
![](https://i.imgur.com/vThleay.png)    
![](https://i.imgur.com/Wac3TwX.png)    
![](https://i.imgur.com/2Gk1uZv.png)     
![](https://i.imgur.com/zVSOn4g.png)    
现在可以运行一下，看效果，这里我们就直接接着写了。回到.h文件：   
![](https://i.imgur.com/3M0lifK.png)    
![](https://i.imgur.com/OycQmT5.png)    
然后去cpp文件实现它，先引入SlAiDataHandle和ASlAiFlobObject的头文件：   
![](https://i.imgur.com/LlTqQRQ.png)   
![](https://i.imgur.com/xlzFNr7.png)    
![](https://i.imgur.com/tr9NBGU.png)    
现在就写完掉落了。那么我们再去.h文件：   
![](https://i.imgur.com/bOH0SOL.png)    
然后去cpp文件实现：   
![](https://i.imgur.com/TsC1jNJ.png)    
接下来去SlAiPlayerControaller.cpp:   
![](https://i.imgur.com/Xliu0f8.png)    
![](https://i.imgur.com/78CyUo1.png)    
修改之前SlAiEnemyTaskDefence.cpp的代码如下:   
![](https://i.imgur.com/rusNTTB.png)     
再去到SlAiEnemyController.cpp文件下：    
![](https://i.imgur.com/1ZGZSsj.png)
删掉这个方法和实现：   
![](https://i.imgur.com/qoLGWxp.png)   
再修改一下代码：   
![](https://i.imgur.com/8YYsbFs.png)   
然后我们运行一下看一下效果：    
![](https://i.imgur.com/LqEMcOh.png)    
现在我们接着写，我们来到SlAiPlayerState.h下添加一个变量和一个方法：    
![](https://i.imgur.com/3wbxnuk.png)    
![](https://i.imgur.com/NVPhui8.png)    
然后去实现它：   
![](https://i.imgur.com/ZReUOzh.png)     
![](https://i.imgur.com/A6MB13A.png)   
![](https://i.imgur.com/MuYuIXw.png)     
然后去SlAiPlayerCharacter.h添加一个方法：   
![](https://i.imgur.com/KyhQxI9.png)    
然后实现它：   
![](https://i.imgur.com/YkejEZ2.png)   
再去SlAiEnemyWeapon.h添加如下代码：   
![](https://i.imgur.com/0DuHmSJ.png)    
然后去实现它：   
![](https://i.imgur.com/ocVYB2c.png)   
![](https://i.imgur.com/J3jAIOT.png)    
我们接下来去到SlAiEnemyAnim.h添加一个给蓝图调用的方法：   
![](https://i.imgur.com/WGZ0Iek.png)      
再去SlAiEnemyCharacter.h添加一个方法调用：   
![](https://i.imgur.com/jAgffN2.png)    
然后先实现这个方法：    
![](https://i.imgur.com/VFCLvHf.png)    
再去实现可以呗蓝图调用的方法：   
![](https://i.imgur.com/s7OhqKu.png)    
饥饿下来去UE4连蓝图：   
![](https://i.imgur.com/yzHLYFU.png)    
这样就完成了，可以运行看一下效果。   
    
2、**渲染小地图**
（1）我们先打开ue4添加材质，来到Material,将材质设为MiniMapMat。    
![](https://i.imgur.com/QMQ5nlJ.png)   
然后打开这个Texture:   
![](https://i.imgur.com/O3aYoyq.png)     
![](https://i.imgur.com/DndTNWF.png)   
接下来创建一个MiniMapMat的实例：   
![](https://i.imgur.com/6NbZiM3.png)    
![](https://i.imgur.com/7nHomXV.png)    
然后创建两个类：   
![](https://i.imgur.com/v95VOW1.png)    
![](https://i.imgur.com/ru1TEhB.png)    
接下来来到vs，在SSlAiGameHUDWidget.h下添加如下引用：    
![](https://i.imgur.com/uzra2W2.png)    
接下来来到cpp文件：   
![](https://i.imgur.com/URJ2muh.png)   
![](https://i.imgur.com/olCbJnH.png)   
然后去SSlAiMinMaoWidget.h下添加如下代码：   
![](https://i.imgur.com/wl6tsPu.png)    
然后来到cpp文件：    
![](https://i.imgur.com/K1Z1LHi.png)    
![](https://i.imgur.com/JKGuBjB.png)      
再去SlAIGameWidgetStyle.h添加笔刷：    
![](https://i.imgur.com/sUp2Hir.png)    
在回去接着写：   
![](https://i.imgur.com/4NuNJs7.png)    
然后去SSlAiMinMapWidget.h添加如下代码：    
![](https://i.imgur.com/YmEbWZk.png) 
再去SlAiSceneCapture2D.h:   
![](https://i.imgur.com/Ebdj0Y8.png)   
再去cpp文件初始化：   
![](https://i.imgur.com/bP472FV.png)    
再去SlAiSceneCapture2D.h:   
![](https://i.imgur.com/aPwBuIH.png)
再接着实现它：   
![](https://i.imgur.com/OYRJJnE.png)    
接下来再去SlAiSceneCapture2D.h绑定它:     
![](https://i.imgur.com/qrCFVGL.png)     
![](https://i.imgur.com/LZHHQrZ.png)    
我们还需要去SlAiGameMode,h添加相机：    
![](https://i.imgur.com/hNn3KvE.png)   
![](https://i.imgur.com/Asm5UP1.png)    
然后我们去cpp文件添加如下代码：    
![](https://i.imgur.com/zg3OO3G.png)   
![](https://i.imgur.com/2CzCMRA.png)    
![](https://i.imgur.com/J71uwUL.png)    
![](https://i.imgur.com/SehZk6C.png)   
我们还需要去SlAiGameMode,h添加委托：   
![](https://i.imgur.com/yyz2J0c.png)    
![](https://i.imgur.com/vfPGBZx.png)   
现在去SSlAiMiniMapWidget.h:   
![](https://i.imgur.com/ChwAoHS.png)    
再去cpp文件实现它：   
![](https://i.imgur.com/yt7A5AR.png)   
然后来到SlAiGameHUD.cpp绑定：     
![](https://i.imgur.com/MsNEx3j.png)     
![](https://i.imgur.com/TjMR9ec.png)    
然后去UE4绑定贴图，大小设320*320：   
![](https://i.imgur.com/mzBy6aO.png)    
然后就可以运行游戏了：   
![](https://i.imgur.com/mvqmN8y.png)   